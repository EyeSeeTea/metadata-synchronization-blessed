"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();!function t(e,n,o){function r(i,a){if(!n[i]){if(!e[i]){var u="function"==typeof require&&require;if(!a&&u)return u(i,!0);if(s)return s(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=n[i]={exports:{}};e[i][0].call(c.exports,function(t){var n=e[i][1][t];return r(n?n:t)},c,c.exports,t,e,n,o)}return n[i].exports}for(var s="function"==typeof require&&require,i=0;i<o.length;i++)r(o[i]);return r}({1:[function(t,e,n){function o(t,e){return t.replace(/{([^{}]*)}/g,function(t,n){var o=e[n];return"string"==typeof o||"number"==typeof o?o:t})}var r=function(){function t(e){_classCallCheck(this,t),this.options=e,this.token="string"==typeof e.token?e.token:e.token.join("")}return _createClass(t,[{key:"init",value:function(){$.feedback(Object.assign({},{postFunction:this._sendReport.bind(this)},this.options.feedbackOptions||{}))}},{key:"_setAuthHeader",value:function(t){t.setRequestHeader("Authorization","token "+this.token)}},{key:"_sendReport",value:function(t){var e=this,n=t.post.img.split(",")[1],o=(new Date).getTime()+parseInt(1e6*Math.random()).toString(),r=this.options.postFunction||function(){};return this._uploadFile("screenshot-"+o+".png",n).then(function(n){return e._getPayload(t,n)}).then(function(t){e.options.createIssue?e._postIssue(t).then(r):r(t)}).then(t.success,t.error)}},{key:"_uploadFile",value:function(t,e){var n={message:"feedback.js snapshot",branch:this.options.snapshots.branch,content:e};return $.ajax({url:"https://api.github.com/repos/"+this.options.snapshots.repository+"/contents/"+t,type:"PUT",beforeSend:this._setAuthHeader.bind(this),dataType:"json",data:JSON.stringify(n)}).then(function(t){return t.content.download_url})}},{key:"_getPayload",value:function(t,e){var n=t.post,r=n.browser,s=["## Browser","- Name: "+r.appCodeName,"- Version: "+r.appVersion,"- Platform: "+r.platform,"","## User report","URL: "+n.url,"",n.note,"","![See screenshot here]( "+e+" )"].join("\n"),i={body:s,username:this.options.username};return{title:o(this.options.issues.title,{title:n.title}),body:this.options.issues.body?o(this.options.issues.body,i):s}}},{key:"_postIssue",value:function(t){return $.ajax({type:"POST",url:"https://api.github.com/repos/"+this.options.issues.repository+"/issues",beforeSend:this._setAuthHeader.bind(this),dataType:"json",data:JSON.stringify(t)}).then(function(e){return Object.assign(t,{issueURL:e.html_url})})}}]),t}();$.feedbackGithub=function(t){var e=new r(t);return e.init(),e}},{}]},{},[1]);